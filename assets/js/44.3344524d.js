(window.webpackJsonp=window.webpackJsonp||[]).push([[44],{319:function(s,t,a){"use strict";a.r(t);var n=a(10),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[s._v("这是关于 "),t("code",[s._v("webpack")]),s._v(" 的一些扩展。")]),s._v(" "),t("p",[t("RouterLink",{attrs:{to:"/tools/webpack/md-to-html-loader.html"}},[s._v("从零开始手写一个简单的 loader（一）")]),s._v(" 里面已经生成了 "),t("code",[s._v("html")]),s._v(" 字符串并且渲染到了页面。但是我们发现其样式无美感，那这一期我们增加一些样式，将生成的 "),t("code",[s._v("html")]),s._v(" 渲染的像咱们博客中的那样。")],1),s._v(" "),t("p",[s._v("首先我们需要的 "),t("code",[s._v("loader")]),s._v(" 是 "),t("code",[s._v("css-loader")]),s._v(" 和 "),t("code",[s._v("style-loader")]),s._v("，我们开始安装这两个依赖。\n"),t("code",[s._v("css-loader")]),s._v(" 用于将 "),t("code",[s._v("css")]),s._v(" 可以模块化的引入，并将其转换为 "),t("code",[s._v("js")]),s._v(" 代码，"),t("code",[s._v("style-loader")]),s._v(" 用于将上一步生成的 "),t("code",[s._v("js")]),s._v(" 中包含的 "),t("code",[s._v("css")]),s._v("，生成可用的样式并且，通过生成 "),t("code",[s._v("style")]),s._v(" 标签插入到 "),t("code",[s._v("head")]),s._v(" 标签中。")]),s._v(" "),t("ul",[t("li",[s._v("安装依赖")])]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("cnpm "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" --save-dev css-loader style-loader\n")])])]),t("p",[s._v("我们接着来配置 "),t("code",[s._v("webpack.config.js")]),s._v(" 文件，在 "),t("code",[s._v("module")]),s._v(" 的 "),t("code",[s._v("rules")]),s._v(" 里再加上一个匹配项:")]),s._v(" "),t("div",{staticClass:"language-diff extra-class"},[t("pre",{pre:!0,attrs:{class:"language-diff"}},[t("code",[s._v("rules: [\n"),t("span",{pre:!0,attrs:{class:"token unchanged"}},[t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[s._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v(" {\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[s._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v("   test: /\\.md$/,\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[s._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v("   use: [\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[s._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v("     './loader/md2html-loader.js'\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[s._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v("   ]\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[s._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v(" },\n")])]),t("span",{pre:!0,attrs:{class:"token inserted-sign inserted"}},[t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v("  {\n")]),t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v("    test: /\\.css$/,\n")]),t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v("    use: [\n")]),t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v("      'style-loader', 'css-loader'\n")]),t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v("    ]\n")]),t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v("  }\n")])]),s._v("]\n")])])]),t("ul",[t("li",[s._v("创建 "),t("code",[s._v("css")]),s._v(" 文件")])]),s._v(" "),t("p",[s._v("紧接着我们在 "),t("code",[s._v("src")]),s._v(" 下创建一个 "),t("code",[s._v("index.css")]),s._v(" 文件，添加如下 "),t("code",[s._v("css")]),s._v(" 样式：")]),s._v(" "),t("div",{staticClass:"language-css extra-class"},[t("pre",{pre:!0,attrs:{class:"language-css"}},[t("code",[t("span",{pre:!0,attrs:{class:"token selector"}},[s._v("pre")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("display")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" block"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("background-color")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" #282c34"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("color")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" #fff"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("padding")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 20px 24px"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("text-align")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" left"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("font-family")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Consolas"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Monaco"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Andale Mono"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Ubuntu Mono"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" monospace"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("border")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 1px solid transparent"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("line-height")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 1.4"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("transition")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" all 0.3s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("font-size")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 14px"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("border-radius")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 5px"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("overflow-x")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" auto"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("margin")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 13px 0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("white-space")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" pre"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("word-spacing")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" normal"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("word-break")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" normal"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("word-wrap")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" normal"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token selector"}},[s._v("pre code")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("font-family")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" inherit"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("color")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" #fff"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("padding")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token selector"}},[s._v("code")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("padding")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 0.2em 0.4em"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("margin")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("font-size")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 85%"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("background-color")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rgba")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("27"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" 31"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" 35"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" 0.05"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("border-radius")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 3px"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v("color")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" palevioletred"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("ul",[t("li",[s._v("引入样式文件")])]),s._v(" "),t("p",[s._v("然后我们回到 "),t("code",[s._v("main.js")]),s._v(" 里将 "),t("code",[s._v("index.css")]),s._v(" 引入：")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./index.css"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("现在我们再去终端运行 "),t("code",[s._v("npx webpack")]),s._v("，再刷新页面，发现生成的 "),t("code",[s._v("html")]),s._v(" 已经被我们加上了样式。")]),s._v(" "),t("img",{attrs:{src:s.$withBase("/assets/images/webpack/render-html.png")}}),s._v(" "),t("p",[s._v("截至目前我们已经完成了一个可以生成 "),t("code",[s._v("html")]),s._v(" 的 "),t("code",[s._v("loader")]),s._v("，并且已经为其加上了样式。")]),s._v(" "),t("p",[s._v("我们目前用的是 "),t("code",[s._v("style-loader")]),s._v(" 是将生成的 "),t("code",[s._v("css")]),s._v(" 通过 "),t("code",[s._v("style")]),s._v(" 的方式插入到 "),t("code",[s._v("head")]),s._v(" 标签中。其实我们还有一种办法，将 "),t("code",[s._v("css")]),s._v(" 提取出来，作为单个文件通过 "),t("code",[s._v("link")]),s._v(" 标签加载。话不多说，我们继续。")]),s._v(" "),t("ul",[t("li",[s._v("提取 "),t("code",[s._v("css")])])]),s._v(" "),t("p",[s._v("要提取 "),t("code",[s._v("css")]),s._v(" 样式文件，"),t("code",[s._v("webpack4.0")]),s._v(" 之后用的插件叫: "),t("code",[s._v("mini-css-extract-plugin")]),s._v("\n我们来安装这个插件:")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("cnpm "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" --save-dev mini-css-extract-plugin\n")])])]),t("p",[s._v("因为 "),t("code",[s._v("style-loader")]),s._v(" 和 "),t("code",[s._v("mini-css-extract-plugin")]),s._v(" 插件不能共存，所以我们需要删除 "),t("code",[s._v("webpack")]),s._v(" 中之前配置的 "),t("code",[s._v("style-loader")]),s._v("，添加 "),t("code",[s._v("mini-css-extract-plugin")]),s._v("，具体修改如下：")]),s._v(" "),t("p",[t("code",[s._v("webpack.config.js")])]),s._v(" "),t("div",{staticClass:"language-diff extra-class"},[t("pre",{pre:!0,attrs:{class:"language-diff"}},[t("code",[t("span",{pre:!0,attrs:{class:"token inserted-sign inserted"}},[t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v(" const MiniCssExtractPlugin = require('mini-css-extract-plugin');\n")])]),s._v("\nmodule: {\n"),t("span",{pre:!0,attrs:{class:"token unchanged"}},[t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[s._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v(" rules: [\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[s._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v("   {\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[s._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v("     test: /\\.md$/,\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[s._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v("     use: [\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[s._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v("       './loader/md2html-loader.js'\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[s._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v("     ]\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[s._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v("   },\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[s._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v("   {\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[s._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v("     test: /\\.css$/,\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[s._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v("     use: [\n")])]),t("span",{pre:!0,attrs:{class:"token inserted-sign inserted"}},[t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v("       MiniCssExtractPlugin.loader, 'css-loader'\n")])]),t("span",{pre:!0,attrs:{class:"token unchanged"}},[t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[s._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v("     ]\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[s._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v("   }\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[s._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v(" ]\n")])]),s._v("},\nplugins: [\n"),t("span",{pre:!0,attrs:{class:"token unchanged"}},[t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[s._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v(" new CleanWebpackPlugin(),\n")]),t("span",{pre:!0,attrs:{class:"token prefix unchanged"}},[s._v(" ")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v(" new HtmlWebpackPlugin(),\n")])]),t("span",{pre:!0,attrs:{class:"token inserted-sign inserted"}},[t("span",{pre:!0,attrs:{class:"token prefix inserted"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token line"}},[s._v(" new MiniCssExtractPlugin()\n")])]),s._v("]\n")])])]),t("p",[s._v("我们再去终端运行 "),t("code",[s._v("npx webpack")]),s._v("，刷新页面发现样式没改变再去看开发人员选项，发现样式文件目前是通过 "),t("code",[s._v("link")]),s._v(" 标签引入的，证明我们的提取 "),t("code",[s._v("css")]),s._v(" 配置是生效的。")]),s._v(" "),t("img",{attrs:{src:s.$withBase("/assets/images/webpack/link-element.png")}}),s._v(" "),t("p",[s._v("至此，我们一个简单的 "),t("code",[s._v("loader")]),s._v(" 就全部完成了。")])])}),[],!1,null,null,null);t.default=e.exports}}]);