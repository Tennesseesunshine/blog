<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>常用的命令 | 某喵喵</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="简单记录、学习笔记">
    
    <link rel="preload" href="/blog/assets/css/0.styles.144fa934.css" as="style"><link rel="preload" href="/blog/assets/js/app.98328165.js" as="script"><link rel="preload" href="/blog/assets/js/2.9875f188.js" as="script"><link rel="preload" href="/blog/assets/js/14.e0563fcb.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.aee8f395.js"><link rel="prefetch" href="/blog/assets/js/11.b53aa4a4.js"><link rel="prefetch" href="/blog/assets/js/12.5a90a46d.js"><link rel="prefetch" href="/blog/assets/js/13.5dda6765.js"><link rel="prefetch" href="/blog/assets/js/15.cc87ac68.js"><link rel="prefetch" href="/blog/assets/js/16.3db1f8f6.js"><link rel="prefetch" href="/blog/assets/js/17.c1174669.js"><link rel="prefetch" href="/blog/assets/js/18.c34fdd97.js"><link rel="prefetch" href="/blog/assets/js/19.cdadf2d2.js"><link rel="prefetch" href="/blog/assets/js/20.4e53fc70.js"><link rel="prefetch" href="/blog/assets/js/21.f91a01ae.js"><link rel="prefetch" href="/blog/assets/js/22.980b7127.js"><link rel="prefetch" href="/blog/assets/js/23.f39e5814.js"><link rel="prefetch" href="/blog/assets/js/24.205cf11b.js"><link rel="prefetch" href="/blog/assets/js/3.6ffaae7e.js"><link rel="prefetch" href="/blog/assets/js/4.48c34b70.js"><link rel="prefetch" href="/blog/assets/js/5.b6391433.js"><link rel="prefetch" href="/blog/assets/js/6.66f56766.js"><link rel="prefetch" href="/blog/assets/js/7.b9c34bfd.js"><link rel="prefetch" href="/blog/assets/js/8.1ef584a3.js"><link rel="prefetch" href="/blog/assets/js/9.0eed14f6.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.144fa934.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><img src="/blog/assets/images/icon.jpeg" alt="某喵喵" class="logo"> <span class="site-name can-hide">某喵喵</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="笔记" class="dropdown-title"><span class="title">笔记</span> <span class="arrow down"></span></button> <button type="button" aria-label="笔记" class="mobile-dropdown-title"><span class="title">笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/notes/linux/shell-export-var-to-nodejs.html" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/blog/notes/node/" class="nav-link">
  Node
</a></li><li class="dropdown-item"><!----> <a href="/blog/notes/vue/concis-event-bus.html" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/blog/notes/react/call-child-component-method.html" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/blog/notes/javascript/promise-resolve-and-return.html" class="nav-link">
  Javascript
</a></li><li class="dropdown-item"><!----> <a href="/blog/notes/network/" class="nav-link">
  网络
</a></li><li class="dropdown-item"><!----> <a href="/blog/notes/browser/anchor-setting.html" class="nav-link">
  浏览器相关
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具使用" class="dropdown-title"><span class="title">工具使用</span> <span class="arrow down"></span></button> <button type="button" aria-label="工具使用" class="mobile-dropdown-title"><span class="title">工具使用</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/tools/vscode/" class="nav-link">
  vscode
</a></li><li class="dropdown-item"><!----> <a href="/blog/tools/charles/" class="nav-link">
  charles
</a></li><li class="dropdown-item"><!----> <a href="/blog/tools/github/github-actions.html" class="nav-link">
  github
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/Tennesseesunshine" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="笔记" class="dropdown-title"><span class="title">笔记</span> <span class="arrow down"></span></button> <button type="button" aria-label="笔记" class="mobile-dropdown-title"><span class="title">笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/notes/linux/shell-export-var-to-nodejs.html" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/blog/notes/node/" class="nav-link">
  Node
</a></li><li class="dropdown-item"><!----> <a href="/blog/notes/vue/concis-event-bus.html" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/blog/notes/react/call-child-component-method.html" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/blog/notes/javascript/promise-resolve-and-return.html" class="nav-link">
  Javascript
</a></li><li class="dropdown-item"><!----> <a href="/blog/notes/network/" class="nav-link">
  网络
</a></li><li class="dropdown-item"><!----> <a href="/blog/notes/browser/anchor-setting.html" class="nav-link">
  浏览器相关
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具使用" class="dropdown-title"><span class="title">工具使用</span> <span class="arrow down"></span></button> <button type="button" aria-label="工具使用" class="mobile-dropdown-title"><span class="title">工具使用</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/tools/vscode/" class="nav-link">
  vscode
</a></li><li class="dropdown-item"><!----> <a href="/blog/tools/charles/" class="nav-link">
  charles
</a></li><li class="dropdown-item"><!----> <a href="/blog/tools/github/github-actions.html" class="nav-link">
  github
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/Tennesseesunshine" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/blog/notes/linux/shell-export-var-to-nodejs.html" class="sidebar-link">导出系统变量</a></li><li><a href="/blog/notes/linux/generic-commands.html" aria-current="page" class="active sidebar-link">常用的命令</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/notes/linux/generic-commands.html#node-中执行-shell" class="sidebar-link">Node 中执行 shell</a></li><li class="sidebar-sub-header"><a href="/blog/notes/linux/generic-commands.html#传参" class="sidebar-link">传参</a></li><li class="sidebar-sub-header"><a href="/blog/notes/linux/generic-commands.html#定义变量" class="sidebar-link">定义变量</a></li><li class="sidebar-sub-header"><a href="/blog/notes/linux/generic-commands.html#条件判断" class="sidebar-link">条件判断</a></li><li class="sidebar-sub-header"><a href="/blog/notes/linux/generic-commands.html#导出变量" class="sidebar-link">导出变量</a></li><li class="sidebar-sub-header"><a href="/blog/notes/linux/generic-commands.html#递归创建文件夹" class="sidebar-link">递归创建文件夹</a></li><li class="sidebar-sub-header"><a href="/blog/notes/linux/generic-commands.html#移动和复制文件" class="sidebar-link">移动和复制文件</a></li><li class="sidebar-sub-header"><a href="/blog/notes/linux/generic-commands.html#打-tar-包和解压缩包" class="sidebar-link">打 tar 包和解压缩包</a></li><li class="sidebar-sub-header"><a href="/blog/notes/linux/generic-commands.html#判断文件存不存在" class="sidebar-link">判断文件存不存在</a></li><li class="sidebar-sub-header"><a href="/blog/notes/linux/generic-commands.html#根据文件更新时间排序-倒序" class="sidebar-link">根据文件更新时间排序（倒序）</a></li><li class="sidebar-sub-header"><a href="/blog/notes/linux/generic-commands.html#获取-json-文本数据" class="sidebar-link">获取 JSON 文本数据</a></li><li class="sidebar-sub-header"><a href="/blog/notes/linux/generic-commands.html#awk" class="sidebar-link">awk</a></li><li class="sidebar-sub-header"><a href="/blog/notes/linux/generic-commands.html#获取其他命令返回值" class="sidebar-link">获取其他命令返回值</a></li><li class="sidebar-sub-header"><a href="/blog/notes/linux/generic-commands.html#查阅改变的日志文件" class="sidebar-link">查阅改变的日志文件</a></li><li class="sidebar-sub-header"><a href="/blog/notes/linux/generic-commands.html#截取字符串" class="sidebar-link">截取字符串</a></li><li class="sidebar-sub-header"><a href="/blog/notes/linux/generic-commands.html#以-js-写-shell-脚本的-zx" class="sidebar-link">以 js 写 shell 脚本的 zx</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p>22 年下半年接触了很多关于运维的知识，涉及到一些 <code>shell</code> 以及 <code>Node</code> 的知识点，汇总一下</p> <h2 id="node-中执行-shell"><a href="#node-中执行-shell" class="header-anchor">#</a> Node 中执行 shell</h2> <p>Node 中提供了 <code>子进程</code> 的模块，可以利用子进程中的方法来实现系统 linux 命令调用，简单示例：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> execSync <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;child_process&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">CMD</span> <span class="token operator">=</span> <span class="token string">&quot;git config --get user.name&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token function">execSync</span><span class="token punctuation">(</span><span class="token constant">CMD</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>以上的代码就类似于，在 zsh 或者命令行终端中执行命令一样，只不过是通过 Node 来执行。</p> <h2 id="传参"><a href="#传参" class="header-anchor">#</a> 传参</h2> <p>首先 shell 可以类似于 Node 执行 js 脚本的时候传参，例如：</p> <ul><li>执行 <code>node ./index.js jack 20</code></li></ul> <p>index.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 获取name和age的参数</span>
<span class="token keyword">const</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token punctuation">,</span> name<span class="token punctuation">,</span> age<span class="token punctuation">]</span> <span class="token operator">=</span> process<span class="token punctuation">.</span>argv<span class="token punctuation">;</span>
</code></pre></div><ul><li>执行 <code>sh index.sh jack 20</code></li></ul> <p>index.sh</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment"># $1为第一个参数 &quot;jack&quot;</span>
<span class="token comment"># $2为第二个参数 &quot;20&quot;</span>
<span class="token comment"># $n以此类推</span>
</code></pre></div><h2 id="定义变量"><a href="#定义变量" class="header-anchor">#</a> 定义变量</h2> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token assign-left variable">ENABLE_CDN</span><span class="token operator">=</span><span class="token string">&quot;1&quot;</span>
</code></pre></div><h2 id="条件判断"><a href="#条件判断" class="header-anchor">#</a> 条件判断</h2> <p>简单的判断</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">$ENABLE_CDN</span> <span class="token operator">=</span> <span class="token string">&quot;1&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;开启&quot;</span>
<span class="token keyword">fi</span>
</code></pre></div><h2 id="导出变量"><a href="#导出变量" class="header-anchor">#</a> 导出变量</h2> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token builtin class-name">export</span> <span class="token assign-left variable">ENABLE_CDN</span><span class="token operator">=</span>true

<span class="token comment"># webpack在依赖Node构建编译的时候，可以通过process.env.ENABLE_CDN来获取变量</span>
<span class="token comment"># 如果页面组件中需要这个变量，也可以在webpack打包的文件中通过define插件来复制到框架中</span>
</code></pre></div><h2 id="递归创建文件夹"><a href="#递归创建文件夹" class="header-anchor">#</a> 递归创建文件夹</h2> <p>当我们需要在为构建的产出做文件命名空间分割的时候，多层目录<code>递归创建</code></p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /output/source/name-space/xx
</code></pre></div><h2 id="移动和复制文件"><a href="#移动和复制文件" class="header-anchor">#</a> 移动和复制文件</h2> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">mv</span> 源文件 目标文件
<span class="token function">cp</span> 源文件 目标文件
</code></pre></div><h2 id="打-tar-包和解压缩包"><a href="#打-tar-包和解压缩包" class="header-anchor">#</a> 打 tar 包和解压缩包</h2> <p>打包 将当前目录下的 pkg 文件夹打为 pkg.tar.gz</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">tar</span> zcvf pkg.tar.gz ./pkg
</code></pre></div><p>解包 将 pkg.tar.gz 解压到 当前 pkg 目录</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">tar</span> zxvf pkg.tar.gz <span class="token parameter variable">-C</span> ./pkg
</code></pre></div><h2 id="判断文件存不存在"><a href="#判断文件存不存在" class="header-anchor">#</a> 判断文件存不存在</h2> <p>判断当前文件是否存在，不存在则退出</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token operator">!</span> <span class="token parameter variable">-f</span> <span class="token string">&quot;./index.js&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;missing index.js&quot;</span>
    <span class="token builtin class-name">exit</span> <span class="token number">1</span>
<span class="token keyword">fi</span>
</code></pre></div><h2 id="根据文件更新时间排序-倒序"><a href="#根据文件更新时间排序-倒序" class="header-anchor">#</a> 根据文件更新时间排序（倒序）</h2> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">ls</span> <span class="token parameter variable">-lt</span>
</code></pre></div><p>举个实际的例子：获取当前文件夹下，时间最新的一个 JSON 文件名</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">ls</span> <span class="token parameter variable">-lt</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">'.json$'</span> <span class="token operator">|</span> <span class="token function">head</span> <span class="token parameter variable">-n</span> <span class="token number">1</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'${print $9}'</span>
</code></pre></div><p>这句话的意思是：先按顺序倒排，然后过滤出来以.json 为后缀的文件，并且去最新的一条，通过 awk 分割获取文件名称</p> <h2 id="获取-json-文本数据"><a href="#获取-json-文本数据" class="header-anchor">#</a> 获取 JSON 文本数据</h2> <p>假设有个 index.json 文件</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;errno&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token property">&quot;result&quot;</span><span class="token operator">:</span> <span class="token string">&quot;okk&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>实际 shell 是通过 py 来执行和获取 index.json 格式的数据</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token assign-left variable">RESULT</span><span class="token operator">=</span>less ./index.json <span class="token operator">|</span> python <span class="token parameter variable">-c</span> <span class="token string">&quot;import sys, json; print json.load(sys.stdin)['result']&quot;</span>
</code></pre></div><p>这里就能得到 index.json 中 result 的结果 <code>echo $RESULT</code> -&gt; <code>okk</code></p> <h2 id="awk"><a href="#awk" class="header-anchor">#</a> awk</h2> <p>awk 可以来过滤和处理文本，$1,$2... 可以理解为 awk 按照某一个词作为分割之后的元素，假如有 index 文本</p> <div class="language-txt extra-class"><pre class="language-txt"><code>&quot;楼栋&quot; &quot;单元&quot; &quot;楼层&quot;
12 6 102
3 8 502
</code></pre></div><p>我们需要组合成 12-6-102 以及 3-8-502 这种格式</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">cat</span> ./index <span class="token operator">|</span> <span class="token function">awk</span> <span class="token parameter variable">-v</span> <span class="token assign-left variable">FS</span><span class="token operator">=</span><span class="token string">' '</span> <span class="token parameter variable">-v</span> <span class="token assign-left variable">OFS</span><span class="token operator">=</span><span class="token string">'-'</span> <span class="token string">'{print $1,$2,$3}'</span>
</code></pre></div><p>其中 FS 指定的是分割的符号，默认 FS 为空格，所以以上可以精简为</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">cat</span> ./index <span class="token operator">|</span> <span class="token function">awk</span> <span class="token parameter variable">-v</span> <span class="token assign-left variable">OFS</span><span class="token operator">=</span><span class="token string">'-'</span> <span class="token string">'{print $1,$2,$3}'</span>
</code></pre></div><p>OFS 是最后需要输出的连接格式，如果只需要后面两位，那就是 {print $2,$3}，并且 awk print 后面可以进行简单的算术运运算</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">cat</span> ./index <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print $1+$2+$3}'</span>
</code></pre></div><h2 id="获取其他命令返回值"><a href="#获取其他命令返回值" class="header-anchor">#</a> 获取其他命令返回值</h2> <p>举个例子，如果我们在 shell 中调用了一段 js 代码，虽然 js 在 node 环境中可以抛出失败或者成功，但是因为不同的进程， shell 无法知道那段程序是否异常或者正常退出，这个时候就需要 shell 拿到 js 执行的结果</p> <p>index.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 程序执行成功退出</span>
    process<span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 程序执行异常退出</span>
    process<span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>sh</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">node</span> ./index.js

<span class="token assign-left variable">NODE_RESULT</span><span class="token operator">=</span><span class="token variable">$?</span>
</code></pre></div><p><code>$?</code> 就是 js 执行之后的返回值，返回的数据就是 exit 中抛出的状态，当获取到 <code>$?</code> 之后，就可以根据上一步的结果来处理下边的逻辑，当上一步执行结果为 1 的时候是异常，此时 shell 也 exit 1 以执行失败退出</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">$NODE_RESULT</span> <span class="token parameter variable">-eq</span> <span class="token number">1</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;node结果执行失败&quot;</span>
    <span class="token builtin class-name">exit</span> <span class="token number">1</span>
<span class="token keyword">fi</span>
</code></pre></div><h2 id="查阅改变的日志文件"><a href="#查阅改变的日志文件" class="header-anchor">#</a> 查阅改变的日志文件</h2> <p>用来查阅正在有请求进来的日志文件</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">tail</span> <span class="token parameter variable">-f</span> filename
</code></pre></div><h2 id="截取字符串"><a href="#截取字符串" class="header-anchor">#</a> 截取字符串</h2> <p>假如我们需要截取一个字符串，可以利用 <code>${变量: start: end}</code> 来进行</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment"># 获取当前系统node的主要版本号</span>

<span class="token assign-left variable">NODE_VERSION</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span><span class="token function">node</span> <span class="token parameter variable">-v</span><span class="token variable">)</span></span>&quot;</span>
<span class="token comment"># 这样获取的是v18.12.1，但是我们只需要18，所以</span>

<span class="token assign-left variable">MAIN_VERSION</span><span class="token operator">=</span><span class="token variable">${NODE_VERSION<span class="token operator">:</span> 1<span class="token operator">:</span> 2}</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">$MAIN_VERSION</span>&quot;</span>

<span class="token comment"># 就能得到需要的版本号18</span>
</code></pre></div><h2 id="以-js-写-shell-脚本的-zx"><a href="#以-js-写-shell-脚本的-zx" class="header-anchor">#</a> 以 js 写 shell 脚本的 zx</h2> <ul><li>它是一个 js 脚本不是 shell，文件以 .mjs 结尾</li> <li>shebang 需要指明为 <code>#!/usr/bin/env zx</code></li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">最后更新:</span> <span class="time">1/28/2023, 2:38:24 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/notes/linux/shell-export-var-to-nodejs.html" class="prev">
        导出系统变量
      </a></span> <!----></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/blog/assets/js/app.98328165.js" defer></script><script src="/blog/assets/js/2.9875f188.js" defer></script><script src="/blog/assets/js/14.e0563fcb.js" defer></script>
  </body>
</html>
